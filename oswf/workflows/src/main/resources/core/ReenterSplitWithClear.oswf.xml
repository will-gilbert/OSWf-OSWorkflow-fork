<?xml version="1.0" encoding="UTF-8" standalone='no' ?>
<!DOCTYPE workflow SYSTEM 'OSWf-3.0.dtd'>
<workflow>
 
    <meta name='description'><![CDATA[
                
    ]]>    
    </meta>    


  <initial-actions>
    <action id="1" name="Start Workflow">
      <results>
        <default-result step="1"/>
      </results>
    </action>
  </initial-actions>


  <steps>
    <step id="1" name="Entry Step">

      <description><![CDATA[

      ]]>
      </description>  

      <actions>
        <action id="2" name="Split into A/B">
        
          <pre-functions>
            <function type='alias' name='clearStep'>
              <arg name="stepId">2,3</arg>
                <arg name="status">P O O F !</arg>
            </function>
          </pre-functions>
            
          <results>
            <default-result split="1"/>
          </results>
        </action>
      </actions>
    </step>



    <step id="2" name="A">
      <actions>
        <action id="3" name="Repeat">
          <results>
            <default-result exit-status="Rejected" status="Repeat" step="1">
            <pre-functions>
              <function type='alias' name='clearStep'>
                <arg name="stepId">1</arg>
                <arg name="status">R E M O V E D</arg>
              </function>
            </pre-functions>
          </default-result>
          </results>
        </action>
        <action id="4" name="Approve">
          <results>
            <default-result exit-status="Approved" join="1"/>
          </results>
        </action>
      </actions>
    </step>


    <step id="3" name="B">
      <actions>
        <action id="5" name="Repeat">
          <results>
            <default-result exit-status="Rejected" status="Repeat" step="1">
            <pre-functions>
              <function type='alias' name='clearStep'>
                <arg name="stepId">1</arg>
                <arg name="status">R E M O V E D</arg>
              </function>
            </pre-functions>
          </default-result>
          </results>
        </action>
        <action id="6" name="Approve">
          <results>
            <default-result exit-status="Approved" join="1"/>
          </results>
        </action>
      </actions>
    </step>
    
    <step id="4" name="End Step" />
    
  </steps>

  <splits>
    <split id="1">
        
      <default-result status="Enter A" step="2"/>
      <default-result status="Enter B" step="3"/>
    </split>
  </splits>

  <joins>
    <join id="1">
        
      <description> Multiple Conditions; type defaults to 'AND' </description>
      
      <conditions>
          
        <condition type="beanshell">
          <arg name="script">"Finished".equals(jn.get(2).getStatus())</arg>
        </condition> 
        
        <condition type="beanshell">
          <arg name="script">"Finished".equals(jn.get(3).getStatus())</arg>
        </condition> 
        
      </conditions>
      <default-result status="Finish" step="4"/>
    </join>
  </joins>
  
  
  
</workflow>
